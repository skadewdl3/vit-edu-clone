---
import Icon from '@components/Icon.vapor.vue'
import { Image } from 'astro:assets'
import logo from '@assets/images/logo.png'

import NavbarIsland from '@components/Navbar.vapor.vue'
import Menu from '@components/Menu.vapor.vue'
---

<!-- <script>
  import { isMenuOpen } from '@store/menu'
  import { throttle } from 'lodash'
  import { navColor as navColorAtom, expectedNavColor as expectedNavColorAtom } from '@store/menu'

  const openMenu = () => isMenuOpen.set(true)
  const expectedNavColor = expectedNavColorAtom.get()

  document.querySelector('.menu-trigger').addEventListener('click', openMenu)
  let navbar = document.querySelector('.navbar')
  let image = document.querySelector('.menu-logo-img')
  let logo = document.querySelector('.menu-logo')
  let sublogo = document.querySelector('.menu-sub-logo')

  let navIsSmall = false

  const scrollListener = throttle(e => {
    if (document.documentElement.scrollTop >= 50 && !navIsSmall) {
      navbar.classList.remove('px-60', 'py-8')
      navbar.classList.add('px-20', 'py-4', 'bg-white/80', 'opacity-90', 'text-black')
      if (expectedNavColor == 'dark') {
        navbar.classList.remove('text-white')
        navbar.classList.add('text-black')
      }
      image.classList.remove('w-28')
      image.classList.add('w-20')
      logo.classList.add('text-4xl')
      logo.classList.remove('text-6xl')
      sublogo.classList.remove('px-28')
      sublogo.classList.add('text-lg', 'px-20')
      expectedNavColor ? navColorAtom.set(expectedNavColor) : navColorAtom.set('dark')
      navIsSmall = true

    } else if (document.documentElement.scrollTop < 50 && navIsSmall) {
      navbar.classList.add('px-60', 'py-8')
      if (expectedNavColor == 'dark') {
        navbar.classList.remove('text-white')
        navbar.classList.add('text-black')
      }
      navbar.classList.remove('px-20', 'py-4', 'bg-white/80', 'opacity-90', 'text-black')
      image.classList.add('w-28')
      image.classList.remove('w-20')
      logo.classList.remove('text-4xl')
      logo.classList.add('text-6xl')
      sublogo.classList.add('px-28')
      sublogo.classList.remove('text-lg', 'px-20')
      expectedNavColor ? navColorAtom.set(expectedNavColor) : navColorAtom.set('light')
      navIsSmall = false
    }
  }, 100)

  window.addEventListener('scroll', scrollListener)
</script> -->
<NavbarIsland client:load>
  <Image src={logo} alt="VIT Logo" slot="logo" />
  <Menu client:load slot="menu">
    <div
      class="menu-bar w-full my-4 mb-40 bg-red flex items-center justify-between"
      slot="menu-bar"
    >
      <div class="menu-bar-left flex flex-col items-start justify-center">
        <div class="menu-logo-main flex items-end justify-start">
          <div class="menu-logo-img w-28 aspect-square">
            <!-- Using Astro's built in Image component gives better optimisation for images -->

            <slot name="logo" />
          </div>
          <div class="menu-logo font-heading text-6xl">ishwakarma</div>
        </div>

        <div class="menu-logo font-heading text-2xl px-28">
          Institute of Technology
        </div>
      </div>
      <button
        class="menu-close text-3xl flex items-center justify-end cursor-pointer text-gray-400 hover:text-white transition-colors"
      >
        Close

        <!-- Even though Icon is also an island, it won't ship with any javascript.
               It will be rendered on server and only html/css will be sent to browser. -->
        <Icon name="x-circle" class="ml-4 w-16" />
      </button>
    </div>
    <Icon name="chevron-right" class="w-8" slot="arrow-right" />
  </Menu>
  <Icon name="bars-2" class="w-8 ml-4" slot="close-icon" />

</NavbarIsland>
